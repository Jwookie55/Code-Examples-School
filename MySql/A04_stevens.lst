--------------
/* Jared Stevens */

    /* enable warnings! */

use   a_vets
--------------

Query OK, 0 rows affected (0.02 sec)

--------------
/*  TASK 00 */ 

select user(), current_date(), version(), @@sql_mode
--------------

*************************** 1. row ***************************
        user(): jared@localhost
current_date(): 2015-09-07
     version(): 5.6.26-log
    @@sql_mode: STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
1 row in set (0.00 sec)

--------------
/*  TASK 01 */

select
	an_id
	, an_type
	, an_name
	, an_dob
	, cl_id
	from a_vets.vt_animals
	where an_type in ('cat', 'dog')
	and an_dob <= '2009-12-31'
--------------

+-------+---------+-----------------+------------+-------+
| an_id | an_type | an_name         | an_dob     | cl_id |
+-------+---------+-----------------+------------+-------+
| 15165 | dog     | Burgess         | 2005-11-20 |   411 |
| 16004 | cat     | Napper          | 2006-06-06 |  6897 |
| 19845 | dog     | Pinkie          | 2009-02-02 |   411 |
| 21003 | dog     | Calvin Coolidge | 2004-06-18 |   411 |
+-------+---------+-----------------+------------+-------+
4 rows in set (0.00 sec)

--------------
	
/*  TASK 02 */

select
	eh.ex_id
	, eh.ex_date
	, ed.srv_id
	, ed.ex_fee
	from a_vets.vt_exam_headers eh
	join a_vets.vt_exam_details ed on eh.ex_id = ed.ex_id 
	join a_vets.vt_animals an on an.an_id = eh.an_id
	where an_type in ('dormouse', 'hamster', 'hedgehog', 'porcupine', 'olinguito' )
	order by ex_id, srv_id
--------------

+-------+---------------------+--------+--------+
| ex_id | ex_date             | srv_id | ex_fee |
+-------+---------------------+--------+--------+
|  3105 | 2014-10-10 09:15:00 |    110 | 150.00 |
|  3105 | 2014-10-10 09:15:00 |    523 |  50.50 |
|  3203 | 2014-11-03 14:30:00 |    524 |  20.00 |
|  3282 | 2014-11-23 10:30:00 |    110 |  50.00 |
|  3282 | 2014-11-23 10:30:00 |    523 |  60.00 |
|  3282 | 2014-11-23 10:30:00 |    615 |  25.25 |
|  3321 | 2015-02-17 10:45:00 |    748 |   0.00 |
|  3322 | 2015-02-10 09:15:00 |    748 |  29.50 |
|  3323 | 2015-02-25 14:30:00 |    524 |  20.00 |
|  3323 | 2015-02-25 14:30:00 |    687 |  45.00 |
|  3393 | 2014-12-23 12:15:00 |    748 |  29.50 |
|  3393 | 2014-12-23 12:15:00 |    749 |   0.00 |
|  3486 | 2014-12-31 13:00:00 |   4601 | 275.00 |
|  4103 | 2015-01-08 15:30:00 |   4601 | 275.00 |
|  4203 | 2015-08-03 14:30:00 |    524 |  20.00 |
|  4233 | 2015-09-03 14:30:00 |    524 |  20.00 |
|  4243 | 2015-06-08 15:30:00 |   4601 | 275.00 |
|  4255 | 2015-07-08 15:30:00 |   4601 | 275.00 |
|  4282 | 2015-08-23 10:30:00 |    110 |  50.00 |
|  4282 | 2015-08-23 10:30:00 |    523 |  60.00 |
|  4282 | 2015-08-23 10:30:00 |    615 |  25.25 |
+-------+---------------------+--------+--------+
21 rows in set (0.00 sec)

--------------
/*  TASK 03 */

select
	st.stf_id
	, concat (st.stf_name_first, ' ' ,st.stf_name_last) as 'Staff'
	, eh.ex_date
	from a_vets.vt_staff st
	join a_vets.vt_exam_headers eh using ( stf_id)
	join a_vets.vt_animals an using ( an_id)
	where an_type not in ('lizard', 'chelonian', 'snake', 'bird')
	order by  ex_date
--------------

+--------+----------------+---------------------+
| stf_id | Staff          | ex_date             |
+--------+----------------+---------------------+
|     29 | Sandy Helfen   | 2014-10-10 09:15:00 |
|     29 | Sandy Helfen   | 2014-11-03 14:30:00 |
|     15 | Eliza Dolittle | 2014-11-10 10:30:00 |
|     15 | Eliza Dolittle | 2014-11-22 09:00:00 |
|     15 | Eliza Dolittle | 2014-11-23 10:30:00 |
|     15 | Eliza Dolittle | 2014-12-01 16:30:00 |
|     15 | Eliza Dolittle | 2014-12-23 08:30:00 |
|     29 | Sandy Helfen   | 2014-12-23 12:15:00 |
|     15 | Eliza Dolittle | 2014-12-26 09:30:00 |
|     15 | Eliza Dolittle | 2014-12-31 13:00:00 |
|     15 | Eliza Dolittle | 2015-01-01 16:30:00 |
|     38 | Rhoda Wabich   | 2015-01-08 15:30:00 |
|     29 | Sandy Helfen   | 2015-02-10 09:15:00 |
|     29 | Sandy Helfen   | 2015-02-17 10:45:00 |
|     29 | Sandy Helfen   | 2015-02-25 14:30:00 |
|     38 | Rhoda Wabich   | 2015-06-08 15:30:00 |
|     38 | Rhoda Wabich   | 2015-07-08 15:30:00 |
|     15 | Eliza Dolittle | 2015-07-23 08:30:00 |
|     29 | Sandy Helfen   | 2015-08-03 14:30:00 |
|     15 | Eliza Dolittle | 2015-08-23 10:30:00 |
|     29 | Sandy Helfen   | 2015-09-03 14:30:00 |
+--------+----------------+---------------------+
21 rows in set (0.00 sec)

--------------
/*  TASK 04 */

select
	an.cl_id
	, ed.ex_id
	, eh.ex_date
	, ed.srv_id
	, ed.ex_fee
	from a_vets.vt_animals an
	join a_vets.vt_exam_headers eh using ( an_id)
	join a_vets.vt_exam_details ed using ( ex_id)
	where ex_fee < 50 
	or ex_fee > 100
	order by ex_date, srv_id
--------------

+-------+-------+---------------------+--------+--------+
| cl_id | ex_id | ex_date             | srv_id | ex_fee |
+-------+-------+---------------------+--------+--------+
|  5699 |  3202 | 2014-10-03 14:30:00 |    341 |  20.00 |
|  5699 |  3105 | 2014-10-10 09:15:00 |    110 | 150.00 |
|  7152 |  3010 | 2014-10-22 10:45:00 |    104 |  25.00 |
|  7152 |  3010 | 2014-10-22 10:45:00 |    605 | 535.00 |
|  7152 |  3001 | 2014-10-24 10:45:00 |    104 |  25.00 |
|  1825 |  3203 | 2014-11-03 14:30:00 |    524 |  20.00 |
|   411 |  3513 | 2014-11-06 10:30:00 |    104 |  30.00 |
|  7152 |  3304 | 2014-11-06 10:30:00 |    341 |  25.00 |
|  7152 |  3304 | 2014-11-06 10:30:00 |   1003 |  25.00 |
|  5699 |  3306 | 2014-11-06 10:45:00 |    104 |  30.00 |
|  5699 |  3306 | 2014-11-06 10:45:00 |    687 |  45.00 |
|  5699 |  3306 | 2014-11-06 10:45:00 |   1002 |  25.00 |
|  1825 |  3552 | 2014-11-10 10:30:00 |    308 |   2.25 |
|  5699 |  3514 | 2014-11-10 10:45:00 |    104 |  30.00 |
|  5699 |  3514 | 2014-11-10 10:45:00 |   1002 |  15.00 |
|  5699 |  3514 | 2014-11-10 10:45:00 |   1003 |  25.00 |
|   411 |  3282 | 2014-11-23 10:30:00 |    615 |  25.25 |
|  1825 |  3413 | 2014-12-01 16:30:00 |    308 |   5.00 |
|  1825 |  3612 | 2014-12-23 08:30:00 |    602 | 222.00 |
|  1825 |  3612 | 2014-12-23 08:30:00 |    604 | 109.00 |
|  1825 |  3612 | 2014-12-23 08:30:00 |    606 |  40.00 |
|  1825 |  3612 | 2014-12-23 08:30:00 |    612 |  25.91 |
|  1825 |  3612 | 2014-12-23 08:30:00 |    613 |  47.00 |
|  1825 |  3612 | 2014-12-23 08:30:00 |    625 | 155.00 |
|  1825 |  3393 | 2014-12-23 12:15:00 |    748 |  29.50 |
|  1825 |  3393 | 2014-12-23 12:15:00 |    749 |   0.00 |
|   411 |  3392 | 2014-12-26 09:30:00 |    398 |  30.00 |
|   411 |  3392 | 2014-12-26 09:30:00 |    400 |  21.00 |
|   411 |  3392 | 2014-12-26 09:30:00 |   1003 |  45.00 |
|  7152 |  3409 | 2014-12-27 10:45:00 |    104 |  25.00 |
|  5699 |  3411 | 2014-12-29 14:00:00 |    341 |  20.00 |
|  5699 |  3412 | 2014-12-30 14:30:00 |    341 |  20.00 |
|  1825 |  3486 | 2014-12-31 13:00:00 |   4601 | 275.00 |
|  1825 |  4103 | 2015-01-08 15:30:00 |   4601 | 275.00 |
|  3560 |  3104 | 2015-01-09 16:30:00 |    613 |  47.00 |
|  7152 |  3325 | 2015-01-15 10:45:00 |    104 |  25.00 |
|  5699 |  3494 | 2015-01-22 09:00:00 |    104 |  30.00 |
|  5699 |  3288 | 2015-01-31 09:00:00 |    104 |  30.00 |
|  5699 |  3288 | 2015-01-31 09:00:00 |    687 |  45.00 |
|  5699 |  3288 | 2015-01-31 09:00:00 |   1002 |  25.00 |
|  1825 |  3322 | 2015-02-10 09:15:00 |    748 |  29.50 |
|  1825 |  3321 | 2015-02-17 10:45:00 |    748 |   0.00 |
|  5699 |  3324 | 2015-02-25 10:45:00 |    104 |  30.00 |
|  5699 |  3324 | 2015-02-25 10:45:00 |    687 |  45.00 |
|  5699 |  3324 | 2015-02-25 10:45:00 |   1002 |  25.00 |
|  1825 |  3323 | 2015-02-25 14:30:00 |    524 |  20.00 |
|  1825 |  3323 | 2015-02-25 14:30:00 |    687 |  45.00 |
|  1825 |  4243 | 2015-06-08 15:30:00 |   4601 | 275.00 |
|  1825 |  4255 | 2015-07-08 15:30:00 |   4601 | 275.00 |
|  1852 |  4612 | 2015-07-23 08:30:00 |    602 | 222.00 |
|  1852 |  4612 | 2015-07-23 08:30:00 |    606 |  40.00 |
|  1852 |  4612 | 2015-07-23 08:30:00 |    612 |  25.91 |
|  1825 |  4203 | 2015-08-03 14:30:00 |    524 |  20.00 |
|  5699 |  4514 | 2015-08-10 10:45:00 |    104 |  30.00 |
|  5699 |  4514 | 2015-08-10 10:45:00 |   1002 |  15.00 |
|  5699 |  4514 | 2015-08-10 10:45:00 |   1003 |  25.00 |
|   411 |  4282 | 2015-08-23 10:30:00 |    615 |  25.25 |
|  1825 |  4233 | 2015-09-03 14:30:00 |    524 |  20.00 |
+-------+-------+---------------------+--------+--------+
58 rows in set (0.00 sec)

--------------
/*  TASK 05 */

select *
	from a_vets.vt_services
	where srv_desc like '%Feline%' 
	and srv_desc not like "%Dental%"
	order by srv_type, srv_id
--------------

+--------+----------------+--------------------------------------------+--------------+
| srv_id | srv_list_price | srv_desc                                   | srv_type     |
+--------+----------------+--------------------------------------------+--------------+
|    225 |          75.00 | Feline PCR Series                          | medicine     |
|    551 |          35.50 | First Feline PCR                           | medicine     |
|    552 |          25.15 | Second Feline PCR                          | medicine     |
|    553 |          25.85 | Third Feline PCR                           | medicine     |
|    108 |          80.00 | Routine Exam-Feline                        | office visit |
|    308 |          45.00 | Followup Exam-Feline                       | office visit |
|   4601 |         275.00 | Feline Behaviour Modification Consultation | treatment    |
+--------+----------------+--------------------------------------------+--------------+
7 rows in set (0.00 sec)

--------------
/*  TASK 06 */

select
	distinct cl.cl_id
	, cl_name_last as "Client"
	from a_vets.vt_clients cl
	join a_vets.vt_animals an on cl.cl_id = an.cl_id
	where an_type in ("dog")
	order by cl_id
--------------

+--------+-------------+
| cl_id  | Client      |
+--------+-------------+
|    411 | Carter      |
|   1825 | Harris      |
|   5689 | Biederbecke |
| 408763 | Turrentine  |
+--------+-------------+
4 rows in set (0.00 sec)

--------------
/*  TASK 07 */

select
	distinct cl.cl_id
	, cl_name_last as "Client"
	from a_vets.vt_clients cl
	join a_vets.vt_animals an on cl.cl_id = an.cl_id
	where an_type not in ("dog")
	order by cl_id
--------------

+-------+-------------+
| cl_id | Client      |
+-------+-------------+
|   411 | Carter      |
|  1825 | Harris      |
|  1852 | Dalrymple   |
|  3560 | Monk        |
|  4534 | Montgomery  |
|  5699 | Biederbecke |
|  6897 | Drake       |
|  7152 | Brubeck     |
+-------+-------------+
8 rows in set (0.00 sec)

--------------
/*  TASK 08 */

select
	distinct cl.cl_id
	, cl_name_last as "Client"
	from a_vets.vt_clients cl
	join a_vets.vt_animals an on cl.cl_id = an.cl_id
	where an_type in ('dormouse', 'hamster', 'hedgehog', 'porcupine', 'olinguito' )
	order by cl_id
--------------

+-------+-------------+
| cl_id | Client      |
+-------+-------------+
|   411 | Carter      |
|  1825 | Harris      |
|  1852 | Dalrymple   |
|  3560 | Monk        |
|  5699 | Biederbecke |
+-------+-------------+
5 rows in set (0.00 sec)

--------------
	
/*  TASK 09 */

select
	distinct cl.cl_id
	, cl_name_last as "Client"
	from a_vets.vt_clients cl
	join a_vets.vt_animals an on cl.cl_id = an.cl_id
	where an_type not in ('dormouse', 'hamster', 'hedgehog', 'porcupine', 'olinguito' )
	order by cl_id
--------------

+--------+-------------+
| cl_id  | Client      |
+--------+-------------+
|    411 | Carter      |
|   1825 | Harris      |
|   1852 | Dalrymple   |
|   3560 | Monk        |
|   4534 | Montgomery  |
|   5689 | Biederbecke |
|   5699 | Biederbecke |
|   6897 | Drake       |
|   7152 | Brubeck     |
| 408763 | Turrentine  |
+--------+-------------+
10 rows in set (0.00 sec)

--------------
/*  TASK 10 */
--------------

Query OK, 0 rows affected (0.00 sec)

Bye

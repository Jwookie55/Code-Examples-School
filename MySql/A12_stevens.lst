--------------
/* Jared Stevens */

    /* enable warnings! */

use   a_bkorders
--------------

Query OK, 0 rows affected (0.01 sec)

--------------
/*  TASK 00 */ 
select user(), current_date(), version(), @@sql_mode
--------------

*************************** 1. row ***************************
        user(): jared@localhost
current_date(): 2015-11-24
     version(): 5.6.26-log
    @@sql_mode: STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
1 row in set (0.00 sec)

--------------
/*  TASK 01 */

select oh.order_date as "Order Date"
, count(oh.order_id) as "Number of Orders"
, sum(od.quantity * od.order_price) as "Amt Due"	
, sum(od.quantity) as "Number of Books"
from a_bkorders.order_headers oh
left join a_bkorders.order_details od using(order_id)
where year(order_date) = 2015
group by order_date with rollup
--------------

+------------+------------------+-----------+-----------------+
| Order Date | Number of Orders | Amt Due   | Number of Books |
+------------+------------------+-----------+-----------------+
| 2015-01-01 |                6 |   1301.25 |              43 |
| 2015-01-02 |                2 |   1290.49 |              51 |
| 2015-01-08 |               14 |   1114.43 |              46 |
| 2015-01-18 |                9 |   1419.89 |              41 |
| 2015-01-20 |                3 |     83.63 |               3 |
| 2015-02-01 |                2 |    177.97 |               3 |
| 2015-02-02 |                3 |   1479.72 |              34 |
| 2015-02-03 |                4 |  12930.75 |             391 |
| 2015-02-04 |                2 |     38.89 |               3 |
| 2015-02-05 |                2 |    928.49 |              51 |
| 2015-02-08 |                6 |   2689.01 |             112 |
| 2015-02-15 |                1 |     40.49 |               1 |
| 2015-03-01 |                1 |    165.00 |              11 |
| 2015-03-02 |                3 |   2107.45 |              45 |
| 2015-03-03 |                1 |   1250.00 |              50 |
| 2015-03-04 |                2 |   2749.50 |             100 |
| 2015-03-05 |                2 |    124.95 |               6 |
| 2015-03-06 |                2 |   1475.60 |              10 |
| 2015-03-08 |                3 |    806.00 |              28 |
| 2015-03-10 |                9 |   4308.40 |             154 |
| 2015-03-14 |                5 |    525.40 |              18 |
| 2015-03-15 |                4 |    297.19 |             102 |
| 2015-03-18 |                6 |   1455.24 |              48 |
| 2015-03-19 |                3 |     96.94 |               3 |
| 2015-03-20 |                4 |    996.68 |              25 |
| 2015-03-21 |                6 |   6096.15 |             157 |
| 2015-03-22 |               10 |   2726.29 |              88 |
| 2015-03-23 |                2 |     59.99 |               2 |
| 2015-03-24 |                1 |     45.00 |               1 |
| 2015-03-25 |                3 |    649.95 |              15 |
| 2015-03-26 |                3 |    287.75 |              14 |
| 2015-03-27 |                5 |   6453.45 |             158 |
| 2015-03-28 |                5 |  22220.38 |             578 |
| 2015-03-29 |                2 |   2500.00 |             100 |
| 2015-03-30 |                1 |    225.00 |               5 |
| 2015-03-31 |               11 |   3100.26 |             109 |
| 2015-04-02 |                1 |     58.00 |               1 |
| 2015-04-04 |                3 |    287.75 |              14 |
| 2015-04-07 |                3 |   4394.95 |             110 |
| 2015-04-11 |                2 |    137.45 |               4 |
| 2015-04-12 |                5 |   4123.93 |             105 |
| 2015-05-03 |                5 |   3150.80 |             106 |
| 2015-05-06 |                8 |  22134.05 |             528 |
| 2015-05-11 |                2 |    137.45 |               4 |
| 2015-06-02 |                4 |    513.50 |              16 |
| 2015-06-05 |                1 |      NULL |            NULL |
| 2015-06-11 |                2 |    137.45 |               4 |
| 2015-06-28 |                3 |   9742.50 |             250 |
| 2015-06-29 |                2 |   2047.80 |              30 |
| 2015-06-30 |                4 |   5433.30 |             112 |
| 2015-07-15 |                6 |    802.59 |              22 |
| 2015-07-22 |                3 |    308.70 |               7 |
| 2015-07-28 |                3 |   9742.50 |             250 |
| 2015-08-11 |                2 |    137.45 |               4 |
| 2015-08-12 |                2 |    119.95 |               3 |
| 2015-08-13 |                4 |    103.90 |               4 |
| 2015-09-19 |                3 |    356.69 |              13 |
| 2015-09-30 |                5 |   2303.59 |              83 |
| 2015-10-22 |                7 |   1604.42 |              40 |
| 2015-10-28 |                3 |    280.40 |              16 |
| 2015-10-29 |                5 |   2053.90 |              70 |
| NULL       |              236 | 154330.60 |            4402 |
+------------+------------------+-----------+-----------------+
62 rows in set (0.00 sec)

--------------
	
/*  TASK 02 */

select coalesce(ydate, 'Grand Total') as "Year"
, case when ydate is null then '........' else coalesce(mdate, 'Year Total') end as "Month"
, case when mdate is null then '........' else coalesce(order_id, 'Month Total') end as "Order Id"
, amtdue as "Amount Due"
, numb as "Number of Books sold"
from(
select year(order_date) as "ydate"
, month(order_Date) as "mdate"
, order_id
, sum(quantity * order_price) as "amtdue"
, sum(quantity) as "numb"
from a_bkorders.order_headers
join a_bkorders.order_details using(order_id)
where order_date between '2014-10-01' and '2015-02-28'
group by year(order_date), month(order_date), order_id with rollup)tbl1
--------------

+-------------+------------+-------------+------------+----------------------+
| Year        | Month      | Order Id    | Amount Due | Number of Books sold |
+-------------+------------+-------------+------------+----------------------+
| 2014        | 11         | 15648       |    4745.00 |                  150 |
| 2014        | 11         | 18003       |     221.70 |                    6 |
| 2014        | 11         | 18013       |      50.90 |                    3 |
| 2014        | 11         | 20019       |    1250.00 |                   50 |
| 2014        | 11         | 20029       |     219.00 |                   20 |
| 2014        | 11         | 20038       |      24.00 |                    2 |
| 2014        | 11         | 30816       |    1250.00 |                   50 |
| 2014        | 11         | 30820       |    1250.00 |                   50 |
| 2014        | 11         | 30821       |      21.90 |                    2 |
| 2014        | 11         | 30822       |     499.50 |                   10 |
| 2014        | 11         | 30824       |    1300.00 |                   30 |
| 2014        | 11         | 30825       |     181.96 |                    4 |
| 2014        | 11         | 30826       |     560.00 |                   16 |
| 2014        | 11         | 30833       |    1250.00 |                   50 |
| 2014        | 11         | 30834       |      49.95 |                    1 |
| 2014        | 11         | 30855       |    1000.00 |                  500 |
| 2014        | 11         | 51840       |      24.00 |                    2 |
| 2014        | 11         | 51841       |    1290.49 |                   51 |
| 2014        | 11         | 51842       |     402.64 |                   16 |
| 2014        | 11         | 51843       |      56.34 |                    2 |
| 2014        | 11         | Month Total |   15647.38 |                 1015 |
| 2014        | 12         | 60002       |      50.90 |                    3 |
| 2014        | 12         | 60005       |   21159.00 |                  502 |
| 2014        | 12         | 60009       |    9879.95 |                  254 |
| 2014        | 12         | 60011       |     195.45 |                    5 |
| 2014        | 12         | 60012       |     137.45 |                    4 |
| 2014        | 12         | 60018       |     123.95 |                    3 |
| 2014        | 12         | 60019       |     564.95 |                   12 |
| 2014        | 12         | 60025       |     199.95 |                    1 |
| 2014        | 12         | 60027       |    2755.55 |                  117 |
| 2014        | 12         | 60029       |     213.14 |                    6 |
| 2014        | 12         | 60030       |     199.95 |                    1 |
| 2014        | 12         | 60032       |    6948.40 |                  168 |
| 2014        | 12         | 60039       |     845.49 |                  153 |
| 2014        | 12         | Month Total |   43274.13 |                 1229 |
| 2014        | Year Total | ........    |   58921.51 |                 2244 |
| 2015        | 1          | 1200        |    1383.90 |                   40 |
| 2015        | 1          | 10465       |      35.99 |                    1 |
| 2015        | 1          | 12005       |      27.29 |                    1 |
| 2015        | 1          | 12712       |      56.34 |                    2 |
| 2015        | 1          | 31840       |      24.00 |                    2 |
| 2015        | 1          | 31841       |    1250.00 |                   50 |
| 2015        | 1          | 31850       |      40.49 |                    1 |
| 2015        | 1          | 51845       |    1277.25 |                   41 |
| 2015        | 1          | 51846       |     642.68 |                   32 |
| 2015        | 1          | 51857       |     185.12 |                    5 |
| 2015        | 1          | 51858       |     116.70 |                    6 |
| 2015        | 1          | 51859       |     113.94 |                    2 |
| 2015        | 1          | 51860       |      55.99 |                    1 |
| 2015        | 1          | Month Total |    5209.69 |                  184 |
| 2015        | 2          | 19224       |     441.52 |                    8 |
| 2015        | 2          | 19253       |      69.00 |                    3 |
| 2015        | 2          | 31852       |      40.49 |                    1 |
| 2015        | 2          | 31853       |     999.00 |                   30 |
| 2015        | 2          | 31855       |      40.49 |                    1 |
| 2015        | 2          | 31860       |      40.49 |                    1 |
| 2015        | 2          | 51847       |      38.89 |                    3 |
| 2015        | 2          | 51848       |     888.00 |                   50 |
| 2015        | 2          | 51849       |    2138.00 |                  100 |
| 2015        | 2          | 51861       |     177.97 |                    3 |
| 2015        | 2          | 51862       |     480.72 |                    4 |
| 2015        | 2          | 51863       |     837.90 |                   42 |
| 2015        | 2          | 51864       |   12092.85 |                  349 |
| 2015        | 2          | Month Total |   18285.32 |                  595 |
| 2015        | Year Total | ........    |   23495.01 |                  779 |
| Grand Total | ........   | ........    |   82416.52 |                 3023 |
+-------------+------------+-------------+------------+----------------------+
66 rows in set (0.00 sec)

--------------
/*  TASK 03 */

select coalesce(ydate, 'Grand Total') as ""
, mdate
, Numord as "Number of Orders"
, AmtDue as "Amt Due"
, Numb as "Number of Books sold"
from(
select year(order_Date) as "ydate"
, coalesce(null, 'Yearly Total') as "mdate"
, count(order_id) as "Numord"
, sum(quantity * order_price) as "AmtDue"
, sum(quantity) as "Numb"
from a_bkorders.order_headers
join a_bkorders.order_details using(order_id)
group by year(order_date) with rollup)tbl1
--------------

+-------------+--------------+------------------+-----------+----------------------+
|             | mdate        | Number of Orders | Amt Due   | Number of Books sold |
+-------------+--------------+------------------+-----------+----------------------+
| 2013        | Yearly Total |               17 |  13249.18 |                  351 |
| 2014        | Yearly Total |              291 | 201896.05 |                 7392 |
| 2015        | Yearly Total |              235 | 154330.60 |                 4402 |
| Grand Total | Yearly Total |              543 | 369475.83 |                12145 |
+-------------+--------------+------------------+-----------+----------------------+
4 rows in set (0.00 sec)

--------------
/*  TASK 04 */

select coalesce(author_id, 'ALL Authors') as "Author ID"
, coalesce(book_id, 'ALL books') as "Book ID"
, coalesce(Numb, '0') as "Total Quantity"
, coalesce(AmtDue, 'No sales') as "Total Sales"
from(
select author_id
, book_id
, sum(quantity) as "Numb"
, sum(quantity * order_price) as "AmtDue"
from a_bkinfo.book_authors
join a_bkorders.order_details using(book_id)
group by author_id, book_id with rollup)tbl1
--------------

+-------------+-----------+----------------+-------------+
| Author ID   | Book ID   | Total Quantity | Total Sales |
+-------------+-----------+----------------+-------------+
| A0094       | 1948      | 12             | 491.28      |
| A0094       | ALL books | 12             | 491.28      |
| A0110       | 1142      | 843            | 28004.90    |
| A0110       | ALL books | 843            | 28004.90    |
| A5748       | 1278      | 1              | 48.00       |
| A5748       | ALL books | 1              | 48.00       |
| A7745       | 1609      | 4              | 75.80       |
| A7745       | ALL books | 4              | 75.80       |
| B0056       | 1877      | 4              | 180.00      |
| B0056       | ALL books | 4              | 180.00      |
| B1112       | 2006      | 45             | 926.95      |
| B1112       | 2007      | 53             | 1916.98     |
| B1112       | ALL books | 98             | 2843.93     |
| B2010       | 1102      | 4              | 199.96      |
| B2010       | 1670      | 60             | 2400.00     |
| B2010       | 1689      | 13             | 717.47      |
| B2010       | ALL books | 77             | 3317.43     |
| B2078       | 2005      | 20             | 900.00      |
| B2078       | ALL books | 20             | 900.00      |
| C0030       | 1106      | 135            | 3896.50     |
| C0030       | 1107      | 107            | 2387.50     |
| C0030       | 1161      | 290            | 8200.00     |
| C0030       | 1162      | 202            | 6536.83     |
| C0030       | ALL books | 734            | 21020.83    |
| C0844       | 1401      | 641            | 34661.00    |
| C0844       | ALL books | 641            | 34661.00    |
| C5820       | 1478      | 5              | 225.00      |
| C5820       | ALL books | 5              | 225.00      |
| C8794       | 1948      | 12             | 491.28      |
| C8794       | ALL books | 12             | 491.28      |
| D0030       | 1109      | 54             | 1865.80     |
| D0030       | 1128      | 1553           | 64559.64    |
| D0030       | ALL books | 1607           | 66425.44    |
| D0050       | 1142      | 843            | 28004.90    |
| D0050       | ALL books | 843            | 28004.90    |
| D0845       | 2009      | 41             | 1359.21     |
| D0845       | ALL books | 41             | 1359.21     |
| D2110       | 1301      | 45             | 2047.50     |
| D2110       | 1304      | 117            | 5491.83     |
| D2110       | ALL books | 162            | 7539.33     |
| D2340       | 1128      | 1553           | 64559.64    |
| D2340       | ALL books | 1553           | 64559.64    |
| D3040       | 1101      | 67             | 3871.81     |
| D3040       | ALL books | 67             | 3871.81     |
| D6290       | 2025      | 560            | 21840.00    |
| D6290       | ALL books | 560            | 21840.00    |
| D8902       | 1182      | 143            | 6433.60     |
| D8902       | ALL books | 143            | 6433.60     |
| D8956       | 1175      | 9              | 334.39      |
| D8956       | 1184      | 6              | 299.94      |
| D8956       | ALL books | 15             | 634.33      |
| F2987       | 1185      | 6              | 299.94      |
| F2987       | ALL books | 6              | 299.94      |
| G4040       | 2009      | 41             | 1359.21     |
| G4040       | ALL books | 41             | 1359.21     |
| G4748       | 1537      | 88             | 1930.24     |
| G4748       | ALL books | 88             | 1930.24     |
| G5050       | 1200      | 21             | 344.30      |
| G5050       | 1774      | 1              | 14.67       |
| G5050       | ALL books | 22             | 358.97      |
| G8495       | 1545      | 7              | 95.80       |
| G8495       | ALL books | 7              | 95.80       |
| H0187       | 1457      | 10             | 539.90      |
| H0187       | ALL books | 10             | 539.90      |
| H0202       | 1185      | 6              | 299.94      |
| H0202       | ALL books | 6              | 299.94      |
| H2987       | 2001      | 1008           | 39523.57    |
| H2987       | ALL books | 1008           | 39523.57    |
| H3145       | 1627      | 7              | 1080.57     |
| H3145       | 1628      | 41             | 1330.55     |
| H3145       | 1629      | 76             | 1516.20     |
| H3145       | ALL books | 124            | 3927.32     |
| H8972       | 1278      | 1              | 48.00       |
| H8972       | ALL books | 1              | 48.00       |
| I0010       | 1109      | 54             | 1865.80     |
| I0010       | ALL books | 54             | 1865.80     |
| I5110       | 2032      | 6              | 233.96      |
| I5110       | ALL books | 6              | 233.96      |
| J6700       | 1457      | 10             | 539.90      |
| J6700       | ALL books | 10             | 539.90      |
| J8845       | 1541      | 9              | 105.90      |
| J8845       | 1542      | 1              | 16.99       |
| J8845       | ALL books | 10             | 122.89      |
| K2002       | 2006      | 45             | 926.95      |
| K2002       | 2007      | 53             | 1916.98     |
| K2002       | ALL books | 98             | 2843.93     |
| K7620       | 1425      | 98             | 2739.68     |
| K7620       | 1448      | 997            | 25566.00    |
| K7620       | 1978      | 25             | 2372.00     |
| K7620       | ALL books | 1120           | 30677.68    |
| K7845       | 1279      | 12             | 472.38      |
| K7845       | ALL books | 12             | 472.38      |
| L0040       | 1128      | 1553           | 64559.64    |
| L0040       | ALL books | 1553           | 64559.64    |
| L0140       | 1108      | 942            | 28410.30    |
| L0140       | ALL books | 942            | 28410.30    |
| L0245       | 1894      | 24             | 844.48      |
| L0245       | ALL books | 24             | 844.48      |
| L0453       | 1188      | 4              | 199.96      |
| L0453       | ALL books | 4              | 199.96      |
| L2444       | 1877      | 4              | 180.00      |
| L2444       | ALL books | 4              | 180.00      |
| L3001       | 1401      | 641            | 34661.00    |
| L3001       | ALL books | 641            | 34661.00    |
| M0024       | 1609      | 4              | 75.80       |
| M0024       | ALL books | 4              | 75.80       |
| M0053       | 1105      | 80             | 4412.00     |
| M0053       | 1110      | 8              | 400.00      |
| M0053       | 1269      | 3              | 186.73      |
| M0053       | ALL books | 91             | 4998.73     |
| M0110       | 1108      | 942            | 28410.30    |
| M0110       | ALL books | 942            | 28410.30    |
| M0150       | 1128      | 1553           | 64559.64    |
| M0150       | ALL books | 1553           | 64559.64    |
| M0157       | 1457      | 10             | 539.90      |
| M0157       | 1678      | 10             | 499.90      |
| M0157       | ALL books | 20             | 1039.80     |
| M0295       | 1543      | 50             | 1250.00     |
| M0295       | 1544      | 100            | 1776.00     |
| M0295       | ALL books | 150            | 3026.00     |
| M3145       | 1626      | 1              | 19.95       |
| M3145       | ALL books | 1              | 19.95       |
| M3200       | 1546      | 14             | 145.46      |
| M3200       | ALL books | 14             | 145.46      |
| N6457       | 1835      | 1              | 45.99       |
| N6457       | ALL books | 1              | 45.99       |
| P0500       | 1279      | 12             | 472.38      |
| P0500       | ALL books | 12             | 472.38      |
| P2308       | 2002      | 27             | 955.00      |
| P2308       | ALL books | 27             | 955.00      |
| P6030       | 2018      | 2              | 99.98       |
| P6030       | ALL books | 2              | 99.98       |
| R0040       | 1457      | 10             | 539.90      |
| R0040       | ALL books | 10             | 539.90      |
| R0700       | 2025      | 560            | 21840.00    |
| R0700       | ALL books | 560            | 21840.00    |
| R2040       | 1102      | 4              | 199.96      |
| R2040       | 1670      | 60             | 2400.00     |
| R2040       | ALL books | 64             | 2599.96     |
| R5808       | 1602      | 996            | 2143.50     |
| R5808       | ALL books | 996            | 2143.50     |
| R5858       | 1357      | 94             | 2433.60     |
| R5858       | ALL books | 94             | 2433.60     |
| S0025       | 1104      | 133            | 5985.00     |
| S0025       | ALL books | 133            | 5985.00     |
| S0205       | 2008      | 108            | 4750.45     |
| S0205       | ALL books | 108            | 4750.45     |
| S1164       | 1180      | 13             | 606.87      |
| S1164       | ALL books | 13             | 606.87      |
| S1900       | 1877      | 4              | 180.00      |
| S1900       | ALL books | 4              | 180.00      |
| S2178       | 2006      | 45             | 926.95      |
| S2178       | 2007      | 53             | 1916.98     |
| S2178       | ALL books | 98             | 2843.93     |
| S2183       | 2005      | 20             | 900.00      |
| S2183       | ALL books | 20             | 900.00      |
| S2548       | 1677      | 1              | 70.00       |
| S2548       | ALL books | 1              | 70.00       |
| S2789       | 2004      | 1              | 49.95       |
| S2789       | ALL books | 1              | 49.95       |
| S3110       | 1305      | 948            | 5672.00     |
| S3110       | 1306      | 20             | 5002.40     |
| S3110       | ALL books | 968            | 10674.40    |
| T6748       | 1877      | 4              | 180.00      |
| T6748       | ALL books | 4              | 180.00      |
| T6789       | 1979      | 1              | 53.99       |
| T6789       | ALL books | 1              | 53.99       |
| W0030       | 1133      | 18             | 332.10      |
| W0030       | ALL books | 18             | 332.10      |
| W0060       | 1109      | 54             | 1865.80     |
| W0060       | ALL books | 54             | 1865.80     |
| W0078       | 1258      | 10             | 451.90      |
| W0078       | ALL books | 10             | 451.90      |
| W2388       | 1677      | 1              | 70.00       |
| W2388       | ALL books | 1              | 70.00       |
| W3145       | 1627      | 7              | 1080.57     |
| W3145       | 1628      | 41             | 1330.55     |
| W3145       | 1629      | 76             | 1516.20     |
| W3145       | ALL books | 124            | 3927.32     |
| W3433       | 1619      | 165            | 3501.88     |
| W3433       | ALL books | 165            | 3501.88     |
| W5145       | 1625      | 1              | 4.00        |
| W5145       | ALL books | 1              | 4.00        |
| Z0878       | 1877      | 4              | 180.00      |
| Z0878       | ALL books | 4              | 180.00      |
| Z0897       | 1877      | 4              | 180.00      |
| Z0897       | ALL books | 4              | 180.00      |
| ALL Authors | ALL books | 19506          | 677136.10   |
+-------------+-----------+----------------+-------------+
188 rows in set (0.00 sec)

--------------
/*  TASK 05 */

select book_1.book_id as "Book ID"
, book_1.page_count as "Page Count"
, (
    select count(page_count)
    from a_bkinfo.books as book_2 
    where book_2.page_count div 150 > book_1.page_count div 150
	) + 1 as ranking
from a_bkinfo.books as book_1
where page_count is not null
and book_id <= 1500
order by page_count desc
--------------

+---------+------------+---------+
| Book ID | Page Count | ranking |
+---------+------------+---------+
|    1448 |       3192 |       1 |
|    1306 |       2895 |       2 |
|    1401 |        976 |       4 |
|    1182 |        918 |       4 |
|    1142 |        879 |      11 |
|    1269 |        848 |      11 |
|    1161 |        780 |      11 |
|    1108 |        680 |      17 |
|    1184 |        650 |      17 |
|    1109 |        650 |      17 |
|    1104 |        604 |      17 |
|    1185 |        595 |      27 |
|    1175 |        538 |      27 |
|    1110 |        520 |      27 |
|    1258 |        500 |      27 |
|    1200 |        488 |      27 |
|    1245 |        488 |      27 |
|    1425 |        468 |      27 |
|    1105 |        450 |      27 |
|    1234 |        416 |      44 |
|    1278 |        408 |      44 |
|    1077 |        401 |      44 |
|    1180 |        400 |      44 |
|    1478 |        368 |      44 |
|    1162 |        350 |      44 |
|    1279 |        336 |      44 |
|    1107 |        325 |      44 |
|    1101 |        300 |      44 |
|    1457 |        300 |      44 |
|    1304 |        300 |      44 |
|    1128 |        275 |      69 |
|    1102 |        250 |      69 |
|    1106 |        250 |      69 |
|    1357 |        240 |      69 |
|    1103 |        125 |      82 |
|    1483 |        125 |      82 |
|    1133 |        125 |      82 |
|    1188 |        105 |      82 |
|    1305 |        100 |      82 |
|    1199 |         98 |      82 |
|    1301 |          0 |      82 |
+---------+------------+---------+
41 rows in set (0.00 sec)

--------------
/*  TASK 06 */

select cast(order_date as Date) as "Order ID"
, sum(quantity) as "Quantity Ordered"
, sum(quantity * order_price) as "Total Sales"
from a_bkorders.order_headers
join a_bkorders.order_details using(order_id)
where month(order_Date) = 03 and year(order_date) = 2014
group by order_date
union
select theDate , 0, 0
from 
(
   select adddate('2014-03-01', numvalue)  as theDate
   from
   (  select b1.val + b2.val + b4.val + b8.val + b16.val + b32.val
      as numvalue
      from
      (  select 0 val union  all  select 1)  b1    cross join
      (  select 0 val union  all  select 2)  b2    cross join
      (  select 0 val union  all  select 4)  b4    cross join
      (  select 0 val union  all  select 8)  b8    cross join
      (  select 0 val union  all  select 16) b16   cross join
      (  select 0 val union  all  select 32) b32   
   ) as gennum
) calendar
where theDate between '2014-03-01'  and '2014-03-31'
and theDate not in (
   select order_date 
   from a_bkorders.order_headers)
Order by 1
--------------

+------------+------------------+-------------+
| Order ID   | Quantity Ordered | Total Sales |
+------------+------------------+-------------+
| 2014-03-01 |                2 |       24.00 |
| 2014-03-02 |               51 |     1290.49 |
| 2014-03-03 |               50 |     1250.00 |
| 2014-03-04 |                6 |      180.00 |
| 2014-03-05 |                0 |        0.00 |
| 2014-03-06 |                0 |        0.00 |
| 2014-03-07 |                0 |        0.00 |
| 2014-03-08 |               37 |     1288.01 |
| 2014-03-09 |                0 |        0.00 |
| 2014-03-10 |                0 |        0.00 |
| 2014-03-11 |                0 |        0.00 |
| 2014-03-12 |               10 |      398.32 |
| 2014-03-13 |                4 |      103.90 |
| 2014-03-14 |                0 |        0.00 |
| 2014-03-15 |                0 |        0.00 |
| 2014-03-16 |                0 |        0.00 |
| 2014-03-17 |                0 |        0.00 |
| 2014-03-18 |                0 |        0.00 |
| 2014-03-19 |                0 |        0.00 |
| 2014-03-20 |              149 |     6794.00 |
| 2014-03-21 |               20 |      519.50 |
| 2014-03-22 |                6 |      394.95 |
| 2014-03-23 |              409 |     1593.00 |
| 2014-03-24 |                3 |       61.89 |
| 2014-03-25 |                2 |      180.00 |
| 2014-03-26 |                3 |       55.95 |
| 2014-03-27 |                0 |        0.00 |
| 2014-03-28 |                0 |        0.00 |
| 2014-03-29 |                0 |        0.00 |
| 2014-03-30 |                0 |        0.00 |
| 2014-03-31 |                0 |        0.00 |
+------------+------------------+-------------+
31 rows in set (0.00 sec)

--------------
/*  TASK 07 */


/*  TASK 08 */


/*  TASK 09 */


/*  TASK 10 */
--------------

Query OK, 0 rows affected (0.00 sec)

Bye
